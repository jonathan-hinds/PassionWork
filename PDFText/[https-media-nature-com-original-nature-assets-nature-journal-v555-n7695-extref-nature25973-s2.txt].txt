Power Simulations 
We performed extensive power simulations to demonstrate that the analyses carried out in our 
study are well powered. Our simulations indicate very high power for all experiments which test 
for association between bacterial and ancestral similarity, and between microbiome composition 
and ancestry proportions (where we define power as the proportion of simulations yielding 
P<0.05). Specifically, we considered several simulation scenarios, generated multiple synthetic 
phenotype vectors according to these scenarios, and tested for association between these vectors 
and genetic/ancestry (depending on the simulation scenario). We then estimated statistical 
power via the fraction of tests with P value < 0.05. 
The simulation settings we considered are as follows: 
1. Simulating a phenotype whose distribution depends on ancestry
proportions. Here, we generated for every individual ğ‘– a synthetic phenotype ğ‘¦ğ‘–
according to the formulas:
ğ‘¦ğ‘– = ğ‘ âˆ‘ ğ‘ğ‘–ğ›½ğ‘
ğ‘
+ ğ’™ğ‘–
ğ‘‡ğœ¸ + ğœ–ğ‘–
ğ›½ğ‘ âˆ¼ ğ’©(0, ğœ
2)
ğœ–ğ‘– âˆ¼ ğ’©(0,1 âˆ’ ğœ
2)
ğœ¸ âˆ¼ ğ’©(ğŸ, ğ¼). 
Here, the summation is performed over ancestries, ğ‘ğ‘– is the ancestry proportion of 
individual  ğ‘– for ancestry ğ‘ (the fraction of grandparents originating from this 
ancestry) after centering to obtain a zero mean, ğ›½ğ‘ is the coefficient of ancestry ğ‘, 
ğ’™ğ‘– is the vector of covariates of individual ğ‘–, ğœ¸ is a vector of covariate effects, ğœ–ğ‘– 
encodes a residual term, ğœ2 âˆˆ (0,1) is the variance of ğ›½ğ‘,  and ğ‘ is constant
guaranteeing that ğ‘¦ğ‘– has a unit variance on average after regressing out the 
covariate effects. Hence, under this formulation ğœ2 controls the fraction of the 
variance of ğ‘¦ğ‘– explained by ancestry (after regressing out the covariate effects). 
We evaluated ğœ2 values in the range [0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,0.999] and 
repeated each experiment 100 times, where in each experiment we (1) randomly 
sampled ğ›½ğ‘, ğœ–ğ‘– and ğœ¸ values from their distribution; (2) generated ğ‘¦ğ‘– values based 
on the true ancestry proportion values ğ‘ğ‘– in our data; (3) regressed the covariates 
ğ‘¥ğ‘– out of ğ‘¦ğ‘–; and (4) tested if the phenotypes vector ğ‘¦ is associated with ancestry 
via a Mantel test with Spearman correlation, where we tested for association 
between Euclidean ancestry distances of individuals ğ‘– and ğ‘— (given by âˆ‘ [ğ‘ğ‘– âˆ’ ğ‘ğ‘—]
2
ğ‘ ) 
and phenotypic differences (given by [ğ‘¦ğ‘– âˆ’ ğ‘¦ğ‘—]
2
).
Steps (3) and (4) in the above procedure mimic the ancestry-microbiome 
association test described in the paper (Figure 1e, Extended Table 1 middle 
column), with the difference that here we test for association with a single 
phenotype ğ‘¦ğ‘– instead of a vector of bacteria. The proposed formulation is designed 
to simulate a genome wide association study, which enables evaluating the 
WWW.NATURE.COM/NATURE | 1
SUPPLEMENTARY INFORMATION
doi:10.1038/nature25973
modelâ€™s power in a well-known setting with a minimal set of assumptions. Although 
the above model could be extended to simulate a multivariate vector instead of a 
scalar phenotype ğ‘¦ğ‘–, this would require introducing additional assumptions into the 
model which would detract from its generalizability.  
The results indicate that our study is very well powered to identify a phenotype 
whose distribution is given by the formulas above, even for small values of ğœ2 
(Supplementary Table 7).  
2. Simulating a bacterial community based on genetic principal components.
Here, we generated for every individual ğ‘–, and for each of the ğ¾ = 184 bacterial
species present in >5% of genotyped individuals, a vector of relative abundances
ğ‘¡ğ‘–
1, â€¦ , ğ‘¡ğ‘–
ğ¾ defined as follows:
ğ‘¡ğ‘–
1, â€¦ , ğ‘¡ğ‘–
ğ¾ âˆ¼ Dir(ğ›¼ğ‘–
1, â€¦ , ğ›¼ğ‘–
ğ¾)
ğ›¼ğ‘–
ğ‘—
= {[1 + exp (âˆ’ âˆ‘ ğ‘ƒğ‘–
ğ‘šğ›½ğ‘—
ğ‘š
5
ğ‘š=1
)]
âˆ’1
ğ‘– â‰¤ ğ‘
0.5 ğ‘– â‰¥ ğ‘
 
ğ›½ğ‘—
ğ‘š âˆ¼ ğ’©(0, ğ‘).
Here, ğ›¼ğ‘–
ğ‘—
 is the Dirichlet concentration parameter of taxon ğ‘— in individual ğ‘– (where
larger values indicate a larger tendency to carry taxon ğ‘—), ğ‘š iterates over the top 
five genetic principal components, ğ‘ƒğ‘–
ğ‘š is the ğ‘šğ‘¡â„ genetic principal component of
individual ğ‘–, ğ›½ğ‘—
ğ‘š is the weight of the ğ‘šğ‘¡â„ genetic principal component with respect
to taxon ğ‘—, ğ‘ is the variance of ğ›½ğ‘—
ğ‘š, and ğ‘ is a tunable parameter controlling the
number of species affected by genetic principal components. Hence, larger values 
of ğ‘ and of ğ‘ indicate that a larger fraction of the microbiome composition is 
affected by genetic ancestry, which should be reflected in the PCos of a microbial 
Î²â€“diversity matrix. 
We carried out experiments where we (1) generated bacterial taxa vectors 
according to the model above, using ğ‘ values in the grid [5,10,20] and ğ‘ values 
corresponding to 0%, 1%, 25%, 50%, 75%, 95% and 100% of ğ¾; (2) computed the 
top PCos of a bacterial Bray-Curtis matrix; and (3) tested for a Spearman 
correlation between the top genetic PCs and the corresponding top microbiome 
PCos, with 100 experiments carried out for each evaluated value of ğ‘. We then 
computed P values for association via the standard asymptotic formulas for either 
a Spearman or a Pearson correlation of two multivariate random variables, and 
performed a multiple hypothesis correction for testing five different hypotheses via 
the Benjamini-Hochberg procedure. We measured power as the fraction of 
experiments with P value < 0.05 (after multiple hypothesis correction). 
The results indicate excellent power for finding correlations between genetic PCs 
and bacterial PCos. (Supplementary Table 8). 
WWW.NATURE.COM/NATURE | 2
SUPPLEMENTARY INFORMATIONRESEARCHdoi:10.1038/nature25973
3. Simulating a bacterial taxon based on ancestry proportions. Here, we
generated for every individual ğ‘– a synthetic species ğ‘¡ğ‘– whose relative abundance is
given by:
ğ‘¡ğ‘– âˆ¼ Beta(1 + ğ‘˜ğ’‚ğ‘–, 1 + ğ‘˜(1 âˆ’ ğ‘ğ‘–)),
where ğ‘ğ‘– is the ancestry proportion of individual ğ‘– for ancestry ğ‘, and ğ‘˜ â‰¥ 0 is a 
tunable parameter which controls the association strength. After generating ğ‘¡ğ‘–, we 
scaled all other bacterial species carried by the same individual so that their total 
relative abundance (including ğ‘¡ğ‘–) sums to unity. Hence, when ğ‘˜ = 0 ğ‘¡ğ‘– is distributed 
uniformly between 0 and 1, whereas larger values of ğ‘˜ induce a greater tendency 
for individuals of ancestry ğ‘ to have a larger taxon abundance, and for individuals 
from other ancestries to have a smaller taxon abundance. 
As before, we repeated the experiment multiple times, where each experiment is 
associated with different values of ğ‘˜ and of an ancestry ğ‘. Specifically, we 
investigated values of ğ‘˜ in the grid [0,0.25,0.5,1,2,5], and repeated each experiment 
100 times. As the above formulation simulates an association between a single 
taxon and a single ancestry, we used our machine learning model to estimate 
power. Specifically, in each experiment we trained a Ridge regression model to 
estimate the ancestry proportions of individuals based on their microbiome, and 
computed the coefficient of determination (ğ‘…2) via a 10-fold cross validation. This 
test mimics the ancestry proportion prediction test described in the results section 
of the main text. We computed approximate P values by generating a distribution 
of 1,000 ğ‘…2 values obtained under ğ‘˜ = 0 (corresponding to the null hypothesis) for 
each ancestry ğ‘, and computing the fraction of null ğ‘…2 values greater than the one 
obtained in practice. 
The results indicate excellent power in the majority of studied settings, and 
especially when ğ‘ corresponds to Ashkenazi ancestry (Supplementary Table 9). 
4. Simulating a phenotype based on genetic kinship. Here, we generated a vector
of synthetic phenotype ğ’š according to the formula:
ğ’š âˆ¼ ğ’©(ğ‘¿ğœ¸, ğœ2ğ‘® + (1 âˆ’ ğœ2)ğ‘°ğ‘›)
ğœ¸ âˆ¼ ğ’©(0, ğ‘°ğ‘)
wh